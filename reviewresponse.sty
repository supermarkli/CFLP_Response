\ProvidesPackage{reviewresponse}[2021/11/10 Review Response v1.2]
% Author: Karl-Ludwig Besser
% Email: k.besser@tu-bs.de

% Updated by Liwenhan Xie (xieliwenhan@yahoo.com)
% Summary of changes: section font configuration and the abbreviations
\RequirePackage{kvoptions}
\RequirePackage[breakable,skins]{tcolorbox}
\RequirePackage{xcolor}

%%% Package Options %%%
\DeclareStringOption{editor}
\DeclareStringOption{journal}
\DeclareStringOption{manuscript}
\ProcessKeyvalOptions*
%%%

%%% Variables
\let\editorname\reviewresponse@editor
\let\journal\reviewresponse@journal
\let\manuscript\reviewresponse@manuscript
\newcommand*{\thetitle}{\@title}
\newcommand*{\theauthor}{\@author}
\newcommand*{\thedate}{\@date}
\newcommand*{\theeditor}{\reviewresponse@editor}
\newcommand*{\themanuscript}{\reviewresponse@manuscript}

%%% Colors
\definecolor{colorcommentfg}{HTML}{336633}
\definecolor{colorcommentbg}{HTML}{ededed}
\definecolor{colorcommentframe}{HTML}{336633}
%\definecolor{colordark}{RGB}{0,63,87}
%\definecolor{colormedium}{RGB}{0,112,155}
%\definecolor{colorlight}{RGB}{102,180,211}
%\colorlet{colorcommentbg}{colorlight!20}

\definecolor{colorchangebg}{HTML}{00AEEF}%e5f9de 424242
\definecolor{colorchangetext}{HTML}{00AEEF}
\definecolor{colorprvbg}{HTML}{949698}%e5f9de
\definecolor{colorprvtext}{HTML}{424242}
\colorlet{colorchangeframe}{black!20}
%%%


%%% General Settings
\setlength{\parindent}{12pt}
\setlength{\parskip}{.25em}
\setlength{\headheight}{15pt}
 \addtolength{\topmargin}{-3pt}
\renewcommand{\baselinestretch}{1.0}   
\textheight 235mm        

%%%

%%% Counters
\newcounter{reviewer@counter}
\setcounter{reviewer@counter}{0}
\newcounter{reviewcomment@counter}[reviewer@counter]
\setcounter{reviewcomment@counter}{0}
%%%

%%% Commands
\renewcommand*{\maketitle}{%
	\begin{titlepage}
		\begin{center}
			\vspace*{1cm}
			\large{稿件 \reviewresponse@manuscript 审稿意见回复}\par
			\vspace{1cm}
			\textbf{\LARGE{\@title}}\par
			\vspace{1cm}
			\large{《信息网络安全》}\par
			\Large{\reviewresponse@journal}\par
			{\large{李子豪\hspace{1em}张锋巍}}
		\end{center}
	\end{titlepage}
}

\newcommand{\editor}{
	\clearpage
	\@ifundefined{pdfbookmark}{}{%
		\pdfbookmark[1]{致编辑的作者回复}{hyperref@editor}%
	}%
	\section*{\textbf{致编辑的作者回复}}
	\addcontentsline{toc}{section}{致编辑的作者回复}
}

\newcommand{\reviewer}[1][]{
	\clearpage
	\refstepcounter{reviewer@counter}%
	\@ifundefined{pdfbookmark}{}{%
		\pdfbookmark[1]{审稿人 \arabic{reviewer@counter}}{hyperref@reviewer\arabic{reviewer@counter}}%
	}%
	\ifx&#1&%
		\section*{\textbf{\bfseries{致审稿人 \arabic{reviewer@counter} 的作者回复}}}
		\addcontentsline{toc}{section}{致审稿人 \arabic{reviewer@counter} 的作者回复}
	\else
		\section*{\textbf{\bfseries{致 #1 的作者回复}}}
		\addcontentsline{toc}{section}{致 #1 的作者回复}
	\fi
}
%%%

%%% Blocks %%%
\newenvironment{generalcomment}{%
% \refstepcounter{reviewcomment@counter}
	\begin{tcolorbox}[adjusted title={总评}, fonttitle={\bfseries}, enhanced jigsaw, colbacktitle={colorcommentframe},arc=0pt,boxrule=0em,opacityframe=0,colback={colorcommentbg}]
}{\end{tcolorbox}}

\newenvironment{revcomment}[2][]{%
	\refstepcounter{reviewcomment@counter}%
	\ifx&#2&%
		\begin{tcolorbox}[adjusted title={意见 \arabic{reviewer@counter}.\arabic{reviewcomment@counter}}, fonttitle={\bfseries}, enhanced jigsaw, colbacktitle={colorcommentframe},arc=0pt,opacityframe=0,boxrule=0em,colback={colorcommentbg},#1]%
		\addcontentsline{toc}{subsection}{意见 \arabic{reviewer@counter}.\arabic{reviewcomment@counter}}%
	\else%
		\begin{tcolorbox}[adjusted title={意见 \arabic{reviewer@counter}.\arabic{reviewcomment@counter}: #2}, fonttitle={\bfseries}, enhanced jigsaw, colbacktitle={colorcommentframe},arc=0pt,opacityframe=0,boxrule=0em,colback={colorcommentbg},#1]%
		\addcontentsline{toc}{subsection}{意见 \arabic{reviewer@counter}.\arabic{reviewcomment@counter}: #2}%
	\fi%
}{\end{tcolorbox}}

\newenvironment{revresponse}[1][{}]{%
	\noindent\textbf{回复 \arabic{reviewer@counter}.\arabic{reviewcomment@counter}:} #1\par
}{\vspace{1em}}

\newenvironment{revmeta}[1][{}]{%
	\textbf{回复摘要：} #1\par
}{\vspace{1em}}

\newenvironment{concludingresponse}[1][]{%
	\begin{tcolorbox}[attach title to upper, breakable, title={结语 #1}, after title={.\enskip}, fonttitle={\bfseries}, coltitle={colorcommentfg}, colback={colorcommentbg}, colframe={colorcommentframe},arc=0pt]
	}{\end{tcolorbox}}

\newenvironment{changes}{
\begin{tcolorbox}[breakable,left skip=0em,enhanced jigsaw, colframe={colorchangebg}, before upper={\parindent 12pt},boxrule=0.0em, leftrule=.5em, opacityback=0, opacityframe=1, arc=1pt]\color{colorchangetext}
}
{\end{tcolorbox}}

\newenvironment{previous}{
\begin{tcolorbox}[breakable,left skip=0em,enhanced jigsaw, colframe={colorprvbg}, before upper={\parindent 12pt},boxrule=0.0em, leftrule=0.5em, opacityback=0, opacityframe=1, arc=1pt]\color{colorprvtext}
}
{\end{tcolorbox}}

\newcommand{\printpartbibliography}[1]{\begin{refsegment}\nocite{#1}\printbibliography[heading=none,segment=\therefsegment]\end{refsegment}}